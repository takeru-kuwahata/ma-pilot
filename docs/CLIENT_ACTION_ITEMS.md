# クライアント依頼事項リスト

**最終更新**: 2026-02-04
**目的**: 開発者検証完了後、クライアントに依頼する作業を一元管理

---

## 📋 依頼事項サマリー

| # | 依頼内容 | 優先度 | 期限目安 | 状態 |
|---|---------|--------|---------|------|
| 1 | 月次データ登録（基礎データ管理） | 🔴 高 | 即時 | ⏳ 未着手 |
| 2 | 経営シミュレーション機能のテスト | 🔴 高 | 月次データ登録後 | ⏳ 未着手 |
| 3 | Google Maps APIキー取得・共有 | 🟡 中 | 1週間以内 | ⏳ 未着手 |
| 4 | 本番環境での動作確認（全ページ） | 🔴 高 | 全機能実装後 | ⏳ 未着手 |

---

## 1. 月次データ登録（基礎データ管理）

### 📍 目的
経営ダッシュボード・経営シミュレーション機能を動作させるため、月次データを登録

### 📝 手順

#### ステップ1: 基礎データ管理ページにアクセス
1. https://ma-pilot.vercel.app にログイン
2. 左メニュー「基礎データ管理」をクリック

#### ステップ2: 月次データ入力方法（2つの方法から選択）

**方法A: CSV一括取込（推奨）**
1. 「CSVファイル選択」ボタンをクリック
2. 以下のフォーマットでCSVファイルを作成してアップロード:

```csv
year_month,total_revenue,insurance_revenue,self_pay_revenue,new_patients,returning_patients,total_patients,personnel_cost,material_cost,fixed_cost,other_cost,chair_count,operating_days,self_pay_rate,unit_utilization
2025-11,8500000,6000000,2500000,35,385,420,3000000,1500000,1200000,600000,6,22,29.4,100
2025-10,8200000,5800000,2400000,32,378,410,2900000,1450000,1200000,580000,6,21,29.3,98
```

**方法B: 手動入力（開発中）**
- 現在、手動入力フォームは未実装
- CSV一括取込をご利用ください

#### ステップ3: データ登録確認
- テーブルに登録したデータが表示されることを確認

### 📊 必須カラム説明
| カラム名 | 説明 | 例 |
|---------|------|-----|
| year_month | 年月（YYYY-MM形式） | 2025-11 |
| total_revenue | 総売上（円） | 8500000 |
| insurance_revenue | 保険診療収入（円） | 6000000 |
| self_pay_revenue | 自費診療収入（円） | 2500000 |
| new_patients | 新患数（人） | 35 |
| returning_patients | 既存患者数（人） | 385 |
| total_patients | 総患者数（人） | 420 |
| personnel_cost | 人件費（円） | 3000000 |
| material_cost | 材料費（円） | 1500000 |
| fixed_cost | 固定費（円） | 1200000 |
| other_cost | その他費用（円） | 600000 |
| chair_count | ユニット数 | 6 |
| operating_days | 営業日数 | 22 |
| self_pay_rate | 自費率（%） | 29.4 |
| unit_utilization | 稼働率（%） | 100 |

### ⚠️ 注意事項
- 最低1ヶ月分のデータ登録が必要
- 経営シミュレーション機能は最新月のデータを基に計算します

---

## 2. 経営シミュレーション機能のテスト

### 📍 目的
経営シミュレーション実行機能の動作確認

### 📝 前提条件
- **必須**: 月次データが1件以上登録されていること（依頼事項#1完了後）

### 📝 テスト手順

#### ステップ1: 経営シミュレーションページにアクセス
1. 左メニュー「経営シミュレーション」をクリック

#### ステップ2: シミュレーション条件設定
1. シミュレーション期間を選択（例: 6ヶ月後）
2. 各変動率を入力:
   - 保険診療収入の変動: 0%（デフォルト）
   - 自費診療収入の変動: 15%（例）
   - 固定費の変動: 5%（例）
   - 新患数の変動: 20%（例）
   - その他はデフォルトのまま

#### ステップ3: シミュレーション実行
1. 「シミュレーション実行」ボタンをクリック
2. 「実行中...」と表示される
3. 数秒後、成功メッセージが表示される

#### ステップ4: 結果確認
以下の項目が表示されることを確認:
- ✅ 予測総売上（金額表示）
- ✅ 予測営業利益（金額表示）
- ✅ 予測利益率（%表示）
- ✅ 売上変動額（+/- 金額表示）
- ✅ 利益変動額（+/- 金額表示）
- ✅ 利益率変動（+/- ポイント表示）

### ⚠️ エラーが出た場合
**エラー: 「月次データが登録されていません」**
- 原因: 依頼事項#1（月次データ登録）が未完了
- 対処: 基礎データ管理ページから月次データを登録

**エラー: 「シミュレーションの実行に失敗しました」**
- 原因: サーバーエラーまたはネットワークエラー
- 対処: 開発者に連絡（kuwahata@idw-japan.net）

### 📊 テスト結果の共有
以下の情報を開発者に共有してください:
1. シミュレーション実行: 成功 / 失敗
2. 結果表示: 正常 / 異常
3. スクリーンショット（あれば）

---

## 3. Google Maps APIキー取得・共有

### 📍 目的
診療圏分析ページで地図表示・競合医院検索機能を有効化

### 📝 手順

#### ステップ1: Google Cloud Consoleでプロジェクト作成
1. https://console.cloud.google.com にアクセス
2. 新しいプロジェクトを作成（例: 「MA-Pilot」）

#### ステップ2: APIを有効化
1. 「APIとサービス」→「ライブラリ」
2. 以下の2つのAPIを有効化:
   - **Maps JavaScript API**（地図表示用）
   - **Places API**（競合医院検索用）

#### ステップ3: APIキー作成
1. 「APIとサービス」→「認証情報」
2. 「認証情報を作成」→「APIキー」
3. 作成されたAPIキーをコピー

#### ステップ4: APIキーの制限設定（セキュリティ推奨）
1. APIキーの「編集」をクリック
2. 「アプリケーションの制限」:
   - 「HTTPリファラー」を選択
   - `https://ma-pilot.vercel.app/*` を追加
3. 「API の制限」:
   - 「キーを制限」を選択
   - Maps JavaScript API と Places API のみ選択

#### ステップ5: APIキーを開発者に共有
- メールまたはセキュアな方法でAPIキーを共有
- フォーマット: `AIza...` （約39文字の文字列）

### 💰 料金について
- **月10,000リクエストまで無料**
- 超過分: 従量課金
  - Maps JavaScript API: $7/1,000リクエスト
  - Places API: $17/1,000リクエスト
- 使用量はGoogle Cloud Consoleで確認可能

### 📊 想定使用量（参考）
- 医院数: 1院
- 月間アクセス想定: 100回程度
- **想定コスト**: 無料枠内で収まる見込み

---

## 4. 本番環境での動作確認（全ページ）

### 📍 目的
開発者検証完了後、クライアント自身の環境で全機能を確認

### 📝 確認項目
詳細は `docs/CLIENT_TEST_CHECKLIST.md` を参照（別途作成予定）

**主要確認項目**:
1. ✅ ログイン・ログアウト
2. ✅ ダッシュボードのデータ表示（依頼事項#1完了後）
3. ✅ 月次データ入力（CSV取込）
4. ✅ 経営シミュレーション（依頼事項#2）
5. ⏳ 診療圏分析（依頼事項#3完了後）
6. ⏳ レポート生成・ダウンロード
7. ⏳ 医院設定・スタッフ管理

### ⏱️ 実施タイミング
- 依頼事項#1-3完了後
- 開発者から「全機能実装完了」の連絡を受けた後

---

## 📌 備考

### 開発者側で実施する作業（クライアント作業不要）
- ✅ e-Stat APIキー取得・設定（無料、開発者が実施）
- ✅ RESAS APIキー取得・設定（無料、開発者が実施）
- ✅ 診療圏分析機能の実装（Google Maps統合）
- ✅ 人口統計データ取得機能の実装（e-Stat統合）

### クライアントから開発者への質問窓口
- メール: kuwahata@idw-japan.net
- 質問例:
  - 「Google Maps APIキーの取得方法が分からない」
  - 「APIキーを取得したが、どこに設定すればいいか？」
  - 「課金が心配。使用量を確認したい」

---

**次回更新予定**: 開発者検証完了後、追加の依頼事項があれば本リストに追加
