# 開発者向け検証チェックリスト

**作成日**: 2026-01-29
**最終更新**: 2026-02-17（UIリファクタリング後の実装状況に同期）
**対象環境**: https://ma-pilot.vercel.app
**ログイン**: kuwahata@idw-japan.net / advance2026

---

## ⚠️ UIリファクタリングによる主要変更点（2026-02-12以降）

| 変更内容 | 旧 | 新 |
|---------|----|----|
| 医院機能URLプレフィックス | `/dashboard` | `/clinic/dashboard` |
| 基礎データ管理URL | `/data-management` | `/clinic/data-management` |
| 診療圏分析URL | `/market-analysis` | `/clinic/market-analysis` |
| シミュレーションURL | `/simulation` | `/clinic/simulation` |
| レポートURL | `/reports` | `/clinic/reports` |
| 医院設定URL | `/clinic-settings` | `/clinic/settings` |
| スタッフ管理URL | `/staff-management` | `/clinic/staff` |
| 印刷物発注URL | `/print-order` | `/clinic/print-order` |
| 印刷物発注履歴URL | `/print-order-history` | `/clinic/print-order-history` |
| 旧URLアクセス | - | Navigate リダイレクト設定済み（旧URL→新URL） |

---

## 検証の進め方

1. 各項目を上から順に検証
2. ✅ = 正常動作、❌ = エラー発生、⚠️ = 動作するが問題あり
3. エラーが出た場合は、**ブラウザのConsole（F12）のエラーメッセージ**をコピー
4. 問題があればすぐに修正対応

---

## 1. 認証・ログイン

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 1.1 | ログイン画面表示 | https://ma-pilot.vercel.app にアクセス | ログインフォームが表示される | [ ] | |
| 1.2 | ログイン成功（system_admin） | メール・パスワード入力→ログインボタン | `/admin/dashboard`に遷移 | [ ] | useAuth.tsで role='system_admin' → /admin/dashboard 確認済み |
| 1.3 | ユーザー情報表示 | ログイン後、右上のアバター確認 | 「システム管理者」と表示 | [ ] | |
| 1.4 | ログアウト | 左メニュー「ログアウト」クリック | `/login`に遷移（Supabaseセッションクリア） | [ ] | ✅ 修正済み（2026-02-17）: `authService.logout()` + `storeLogout()` を呼び出し済み |

---

## 2. 管理機能（5ページ）

### 2.1 管理ダッシュボード (`/admin/dashboard`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 2.1.1 | ページ表示 | 左メニュー「管理ダッシュボード」クリック | KPI・グラフ・医院リストが表示 | [ ] | adminService.getDashboard() / getClinics() でAPI接続済み |
| 2.1.2 | KPI表示 | 画面上部のカード確認 | 登録医院数・アクティブ医院数等が表示 | [ ] | |
| 2.1.3 | グラフ表示 | 「登録医院数推移」グラフ確認 | Rechartsグラフが表示される | [ ] | |
| 2.1.4 | 医院リスト表示 | 「最近の登録医院」テーブル確認 | 登録済み医院が表示 | [ ] | |

### 2.2 医院アカウント管理 (`/admin/clinics`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 2.2.1 | ページ表示 | 左メニュー「医院アカウント管理」クリック | 医院リスト・検索バー・フィルタが表示 | [ ] | フィルタ: 全て/アクティブ/トライアル/停止中 |
| 2.2.2 | 医院リスト表示 | テーブル確認 | 登録済み医院が表示 | [ ] | |
| 2.2.3 | 検索機能 | 検索バーに「さくら」入力 | フィルタリングされる | [ ] | |
| 2.2.4 | 新規登録ボタン | 「＋ 新規医院登録」ボタンクリック | ダイアログが表示される | [ ] | ✅ 実装済み（handleAddClinic→ダイアログ→handleCreateClinic でAPI呼び出し） |
| 2.2.5 | ステータス切替 | 停止/再開ボタンクリック | ステータスが変わる | [ ] | handleToggleStatus でAPI呼び出し済み |
| 2.2.6 | 詳細表示 | 「詳細」ボタンクリック | ダイアログ表示 | ❌ | TODO: Phase 4未実装（alert相当） |
| 2.2.7 | 編集 | 「編集」ボタンクリック | 編集ダイアログ表示 | ❌ | TODO: Phase 4未実装 |

### 2.3 システム設定 (`/admin/settings`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 2.3.1 | ページ表示 | 左メニュー「システム設定」クリック | 設定フォームが表示 | [ ] | UI実装済み |
| 2.3.2 | 外部API設定表示 | e-Stat API設定確認 | 入力フィールドが表示 | [ ] | ダミー値表示中 |
| 2.3.3 | 外部API保存 | 「保存する」ボタンクリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |
| 2.3.4 | 接続テスト | 「接続テスト」ボタンクリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |
| 2.3.5 | メール設定保存 | 「保存する」クリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |
| 2.3.6 | テストメール送信 | 「テストメール送信」クリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |
| 2.3.7 | システム設定保存 | 「保存」クリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |

**注**: システム設定の全保存機能がTODO。クライアントテストには影響なし（管理者専用機能）。

### 2.4 価格表管理 (`/admin/price-tables`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 2.4.1 | ページ表示 | 左メニュー「価格表管理」クリック | 価格表リストが表示 | [ ] | 旧チェックリストには未記載 |

### 2.5 印刷物受注管理 (`/admin/print-orders`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 2.5.1 | ページ表示 | 左メニュー「印刷物受注管理」クリック | 受注一覧が表示 | [ ] | 旧チェックリストには未記載 |

---

## 3. 医院機能（9ページ）

### 3.1 ダッシュボード (`/clinic/dashboard`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.1.1 | ページ表示 | 左メニュー「ダッシュボード」クリック | KPI・グラフが表示 | [ ] | デモデータ表示 |
| 3.1.2 | KPI表示 | 3つのKPIカード確認 | 総売上・営業利益・総患者数が表示 | [ ] | |
| 3.1.3 | 売上・利益推移グラフ | 「売上・利益推移」グラフ確認 | 折れ線グラフが表示 | [ ] | |
| 3.1.4 | 患者数グラフ | 「患者数推移」グラフ確認 | 棒グラフが表示 | [ ] | |
| 3.1.5 | 稼働率グラフ | 「ユニット稼働率推移」確認 | 折れ線グラフ表示 | [ ] | |
| 3.1.6 | 自費率グラフ | 「自費率推移」確認 | 折れ線グラフ表示 | [ ] | |

### 3.2 基礎データ管理 (`/clinic/data-management`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.2.1 | ページ表示 | 左メニュー「基礎データ管理」クリック | ページが表示される | [ ] | |
| 3.2.2 | データ入力フォーム | 「新規データ入力」ボタンクリック | ⚠️ Toast「月次データ入力機能は開発中です」が表示 | ❌ | **未実装のまま**（MonthlyDataFormコンポーネントは存在するが未統合） |
| 3.2.3 | 登録済みデータ一覧 | テーブル確認 | 登録済みデータが表示される | [ ] | 現在は「データがありません」 |
| 3.2.4 | CSV取込 | 「CSVファイル選択」ボタンクリック | ファイル選択ダイアログが表示 | [ ] | 実装済み |

**注**: `MonthlyDataForm.tsx`コンポーネントは`src/components/`に存在するが、DataManagement.tsxに未統合。

### 3.3 診療圏分析 (`/clinic/market-analysis`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.3.1 | ページ表示 | 左メニュー「診療圏分析」クリック | ページが表示される | [ ] | marketAnalysisService.getMarketAnalysis() でAPI接続済み |
| 3.3.2 | 統計カード表示 | 4枚のカード確認 | カードが表示される | [ ] | |
| 3.3.3 | 統計データ表示 | 人口・高齢化率・競合医院数等確認 | データが表示（またはゼロ表示） | ⚠️ | DBにデータなければゼロ表示 |
| 3.3.4 | 地図表示 | 診療圏マップ確認 | プレースホルダー「診療圏マップ（準備中）」が表示 | ⚠️ | 意図的未実装（将来Phase 6でGoogle Maps実装） |
| 3.3.5 | 競合医院一覧 | 周辺競合歯科医院確認 | 「データがありません」または一覧 | ⚠️ | DBにデータなければ空表示 |

### 3.4 経営シミュレーション (`/clinic/simulation`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.4.1 | ページ表示 | 左メニュー「経営シミュレーション」クリック | シミュレーションフォームが表示 | [ ] | simulationService でAPI接続済み |
| 3.4.2 | 条件設定 | 各変動率フィールドに値を入力 | 入力できる | [ ] | 5%刻みstep属性あり |
| 3.4.3 | シミュレーション実行 | 「シミュレーション実行」ボタンクリック | 結果が表示される | [ ] | |
| 3.4.4 | 結果表示 | シミュレーション結果確認 | 6つの指標が表示される | [ ] | |
| 3.4.5 | エラーハンドリング | 月次データ未登録状態でテスト | エラーメッセージが表示される | [ ] | Toast通知実装済み |
| 3.4.6 | 推移予測グラフ | グラフ表示確認 | プレースホルダー「推移予測グラフ（準備中）」が表示 | ⚠️ | 意図的未実装（引き渡し後に実装） |

### 3.5 レポート管理 (`/clinic/reports`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.5.1 | ページ表示 | 左メニュー「レポート管理」クリック | ページが表示される | [ ] | reportService でAPI接続済み |
| 3.5.2 | テンプレート表示 | 3つのテンプレートカード確認 | カードが表示される | [ ] | 月次経営・診療圏分析・シミュレーション |
| 3.5.3 | テンプレートダウンロード | ダウンロードボタンクリック | レポート生成・ダウンロード | [ ] | reportService.generateReport() 実装済み |
| 3.5.4 | レポート生成履歴表示 | 「レポート生成履歴」テーブル確認 | 履歴が表示される | [ ] | 現在は「レポートがありません」 |
| 3.5.5 | 履歴ダウンロード | 履歴のダウンロードボタンクリック | PDFダウンロード | ⚠️ | 実装済みだがデータなし |
| 3.5.6 | カスタムレポート作成 | 「カスタムレポート作成」ボタンクリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |
| 3.5.7 | 削除機能 | 削除ボタンクリック | ⚠️ TODO: 未実装 | ❌ | Phase 4 TODO |

### 3.6 印刷物発注 (`/clinic/print-order`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.6.1 | ページ表示 | 左メニュー「印刷物発注」クリック | 発注フォームが表示 | [ ] | |
| 3.6.2 | パターン選択 | 相談フォーム/再注文を選択 | パターン切替が動作 | [ ] | |
| 3.6.3 | 商品種類選択 | 再注文で商品種類選択 | ドロップダウン表示 | [ ] | 5種類対応 |
| 3.6.4 | 数量選択 | 数量ドロップダウン選択 | 選択できる | [ ] | 100〜5,000枚 |
| 3.6.5 | 見積もり自動計算 | 商品種類・数量選択 | 見積金額が即座に表示 | [ ] | 価格マスタ連動 |
| 3.6.6 | 納期希望日 | 日付選択 | カレンダーが表示 | [ ] | |
| 3.6.7 | バリデーション | 必須項目未入力で送信 | エラーメッセージ表示 | [ ] | |
| 3.6.8 | 注文送信 | 「注文を送信」ボタンクリック | 成功メッセージ | [ ] | |
| 3.6.9 | デザインファイルアップロード | ファイル選択 | アップロード | ❌ | 未実装 |
| 3.6.10 | Stripe決済 | 決済フォーム | 決済できる | ❌ | 未実装 |

### 3.7 印刷物発注履歴 (`/clinic/print-order-history`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 3.7.1 | ページ表示 | 左メニュー「印刷物発注履歴」クリック | 履歴テーブルが表示 | [ ] | 現在は「注文がありません」 |
| 3.7.2 | 見積書PDF生成 | 再注文パターンで送信後確認 | PDFが生成される | [ ] | WeasyPrint実装済み |
| 3.7.3 | ステータス変更（管理者） | 管理者がステータス変更 | 変更できる | ❌ | 未実装 |

---

## 4. 設定機能（2ページ）

### 4.1 医院設定 (`/clinic/settings`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 4.1.1 | ページ表示 | 左メニュー「医院設定」クリック | 医院情報フォームが表示 | [ ] | clinicService.getClinic() でAPI接続済み |
| 4.1.2 | データ読み込み | ページ読み込み時 | DBからデータが取得・表示される | [ ] | ✅ useEffectで実装済み（旧チェックリストでは❌だったが修正済み） |
| 4.1.3 | 基本情報保存 | 「保存する」ボタンクリック | 成功メッセージ表示 | [ ] | ✅ clinicService.updateClinic() 実装済み（旧チェックリストでは❌だったが修正済み） |
| 4.1.4 | 経営情報保存 | 「保存する」ボタンクリック | 成功メッセージ表示 | [ ] | ✅ 同上 |

**注**: 旧チェックリスト（1/29）では「未実装（TODO）」だったが、現在は実装済み。

### 4.2 スタッフ管理 (`/clinic/staff`)

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 4.2.1 | ページ表示 | 左メニュー「スタッフ管理」クリック | スタッフリストが表示 | [ ] | staffService.getStaff(user.clinic_id) でAPI接続済み（`clinic_id`スネークケースに統一済み） |
| 4.2.2 | スタッフ一覧表示 | テーブル確認 | スタッフが表示される | [ ] | |
| 4.2.3 | スタッフ招待 | 「スタッフを招待」ボタンクリック | ダイアログが表示 | [ ] | ✅ 招待ダイアログ＋staffService.inviteStaff() 実装済み（旧チェックリストでは❌） |
| 4.2.4 | 招待メール送信 | メール入力→「招待する」クリック | 送信される | [ ] | ✅ 実装済み |
| 4.2.5 | スタッフ編集 | 編集ボタンクリック | 編集ダイアログが表示 | [ ] | ✅ handleSaveEdit 実装済み（旧チェックリストでは❌） |
| 4.2.6 | スタッフ削除 | 削除ボタンクリック | 確認後削除される | [ ] | ✅ 実装済み |

**注**: 旧チェックリスト（1/29）で「緊急問題」だったclinic_id/clinicIdフィールド名不一致は修正済み。招待・編集もalertではなくダイアログで実装済み。

---

## 5. 共通機能

### 5.1 ナビゲーション

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 5.1.1 | 医院メニュー表示 | ログイン後、左サイドバー確認 | 医院向け9項目が表示される | [ ] | menuConfig.tsxで権限別メニュー管理 |
| 5.1.2 | 管理者メニュー表示 | system_adminでログイン | 管理者向け5項目が表示される | [ ] | |
| 5.1.3 | メニュー切替（admin） | AdminLayoutの「医院モードに切替」クリック | 医院向けメニューに切り替わる | [ ] | AdminModeWrapper.tsx実装済み |
| 5.1.4 | ログアウト | 「ログアウト」クリック | `/login`に遷移（Supabaseセッションクリア） | [ ] | ✅ 修正済み（2026-02-17） |
| 5.1.5 | 旧URL自動リダイレクト | `/dashboard`にアクセス | `/clinic/dashboard`に自動転送 | [ ] | Navigate設定済み |

### 5.2 権限保護

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 5.2.1 | 未認証アクセス | ログアウト状態で `/clinic/dashboard` にアクセス | `/login`にリダイレクト | [ ] | PrivateRoute実装済み |
| 5.2.2 | 権限外アクセス | 医院ユーザーで `/admin/dashboard` にアクセス | `/forbidden`に転送 | [ ] | RoleRoute実装済み |
| 5.2.3 | Forbiddenページ | `/forbidden`にアクセス | Forbiddenページが表示 | [ ] | Forbidden.tsx実装済み |

### 5.3 レスポンシブ対応

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 5.3.1 | スマホ表示 | ブラウザ幅を狭める（F12→デバイスツールバー） | レイアウトが崩れない | [ ] | |
| 5.3.2 | タブレット表示 | 768px幅で確認 | メニューが適切に表示される | [ ] | |

---

## 6. エラーハンドリング

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 6.1 | 存在しないURL | `/nonexistent`にアクセス | `/login`にリダイレクト | [ ] | App.tsxで `<Route path="*" → /login>` 設定済み（404ページなし） |
| 6.2 | API接続エラー | ネットワークタブで確認 | 500エラーが出ていないか | [ ] | |
| 6.3 | Console警告 | F12→Console確認 | 重大なエラーが出ていないか | [ ] | |

---

## 7. パフォーマンス

| # | 項目 | 手順 | 期待結果 | 結果 | 備考 |
|---|------|------|----------|------|------|
| 7.1 | ページ読み込み速度 | 各ページのロード時間測定 | 3秒以内 | [ ] | |
| 7.2 | グラフ描画速度 | ダッシュボードのグラフ表示時間 | 2秒以内 | [ ] | |

---

## 未実装機能サマリー（検証対象外・優先度別）

### 🔴 クライアント検証前に要対応

| 機能 | 場所 | 現状 | 工数目安 |
|------|------|------|---------|
| 月次データ手動入力フォーム | DataManagement.tsx | MonthlyDataFormコンポーネントが存在するが未統合 | 3時間 |

### 🟡 クライアント検証後（引き渡し後）に対応

| 機能 | 場所 | 現状 | 備考 |
|------|------|------|------|
| Render.comスリープ問題 | インフラ | 初回アクセス時に30秒〜数分の遅延が発生。UptimeRobot（無料）で5分毎にping設定で解消できる | 先方への事前説明または設定後に渡す |

### 🟡 クライアント検証後に実装

| 機能 | 場所 | 現状 |
|------|------|------|
| 推移予測グラフ | Simulation.tsx | プレースホルダー表示 |
| カスタムレポート作成 | Reports.tsx | TODO |
| レポート削除 | Reports.tsx | TODO |
| AdminClinics 詳細・編集ダイアログ | AdminClinics.tsx | TODO |
| システム設定の全保存機能 | AdminSettings.tsx | TODO（全てPhase 4 TODO） |

### 🟢 将来実装（Phase 5-6）

| 機能 | 場所 | 現状 |
|------|------|------|
| Google Maps統合 | MarketAnalysis.tsx | プレースホルダー |
| デザインファイルアップロード | PrintOrderForm.tsx | 未実装 |
| Stripe決済 | PrintOrderForm.tsx | 未実装 |
| 印刷物受注ステータス変更（管理者） | PrintOrderHistory.tsx | 未実装 |

---

## 検証結果サマリー

**検証日時**: ____________
**検証者**: ____________

**総合評価**:
- ✅ 正常: ____ 項目
- ⚠️ 要改善: ____ 項目
- ❌ エラー: ____ 項目
- [ ] 未検証: ____ 項目

**クリティカルな問題**:
1.
2.
3.

**次のアクション**:
1.
2.
3.

---

## 検証後の対応フロー

1. **エラーが出たページ**を報告
2. 優先度に応じて修正（クリティカル > 高 > 中 > 低）
3. 修正後、再検証
4. 全項目✅になったら、クライアント向けドキュメント更新

---

**備考**:
- この検証は**シークレットウィンドウ（Cmd+Shift+N）**で実施すること
- 各ページで**F12→Console**を開いてエラーを確認すること
- 問題があればスクリーンショット撮影
