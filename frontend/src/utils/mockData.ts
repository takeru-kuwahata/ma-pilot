import { MonthlyData } from '../types';

// モックデータ: 月次経営データ（直近12ヶ月）
export const mockMonthlyData: MonthlyData[] = [
  {
    id: '1',
    clinic_id: 'clinic-1',
    year_month: '2024-01',
    total_revenue: 8500000,
    insurance_revenue: 6000000,
    self_pay_revenue: 2500000,
    personnel_cost: 3400000,
    material_cost: 1700000,
    fixed_cost: 1200000,
    other_cost: 400000,
    new_patients: 45,
    returning_patients: 320,
    total_patients: 365,
    treatment_count: 580,
    average_revenue_per_patient: 23288,
    created_at: '2024-01-31T00:00:00Z',
    updated_at: '2024-01-31T00:00:00Z',
  },
  {
    id: '2',
    clinic_id: 'clinic-1',
    year_month: '2024-02',
    total_revenue: 7800000,
    insurance_revenue: 5500000,
    self_pay_revenue: 2300000,
    personnel_cost: 3400000,
    material_cost: 1560000,
    fixed_cost: 1200000,
    other_cost: 350000,
    new_patients: 38,
    returning_patients: 295,
    total_patients: 333,
    treatment_count: 530,
    average_revenue_per_patient: 23424,
    created_at: '2024-02-29T00:00:00Z',
    updated_at: '2024-02-29T00:00:00Z',
  },
  {
    id: '3',
    clinic_id: 'clinic-1',
    year_month: '2024-03',
    total_revenue: 9200000,
    insurance_revenue: 6500000,
    self_pay_revenue: 2700000,
    personnel_cost: 3400000,
    material_cost: 1840000,
    fixed_cost: 1200000,
    other_cost: 450000,
    new_patients: 52,
    returning_patients: 348,
    total_patients: 400,
    treatment_count: 630,
    average_revenue_per_patient: 23000,
    created_at: '2024-03-31T00:00:00Z',
    updated_at: '2024-03-31T00:00:00Z',
  },
  {
    id: '4',
    clinic_id: 'clinic-1',
    year_month: '2024-04',
    total_revenue: 8800000,
    insurance_revenue: 6200000,
    self_pay_revenue: 2600000,
    personnel_cost: 3400000,
    material_cost: 1760000,
    fixed_cost: 1200000,
    other_cost: 420000,
    new_patients: 48,
    returning_patients: 332,
    total_patients: 380,
    treatment_count: 600,
    average_revenue_per_patient: 23158,
    created_at: '2024-04-30T00:00:00Z',
    updated_at: '2024-04-30T00:00:00Z',
  },
  {
    id: '5',
    clinic_id: 'clinic-1',
    year_month: '2024-05',
    total_revenue: 9500000,
    insurance_revenue: 6700000,
    self_pay_revenue: 2800000,
    personnel_cost: 3400000,
    material_cost: 1900000,
    fixed_cost: 1200000,
    other_cost: 480000,
    new_patients: 55,
    returning_patients: 365,
    total_patients: 420,
    treatment_count: 660,
    average_revenue_per_patient: 22619,
    created_at: '2024-05-31T00:00:00Z',
    updated_at: '2024-05-31T00:00:00Z',
  },
  {
    id: '6',
    clinic_id: 'clinic-1',
    year_month: '2024-06',
    total_revenue: 9100000,
    insurance_revenue: 6400000,
    self_pay_revenue: 2700000,
    personnel_cost: 3400000,
    material_cost: 1820000,
    fixed_cost: 1200000,
    other_cost: 460000,
    new_patients: 50,
    returning_patients: 355,
    total_patients: 405,
    treatment_count: 640,
    average_revenue_per_patient: 22469,
    created_at: '2024-06-30T00:00:00Z',
    updated_at: '2024-06-30T00:00:00Z',
  },
  {
    id: '7',
    clinic_id: 'clinic-1',
    year_month: '2024-07',
    total_revenue: 8600000,
    insurance_revenue: 6100000,
    self_pay_revenue: 2500000,
    personnel_cost: 3400000,
    material_cost: 1720000,
    fixed_cost: 1200000,
    other_cost: 410000,
    new_patients: 46,
    returning_patients: 325,
    total_patients: 371,
    treatment_count: 590,
    average_revenue_per_patient: 23180,
    created_at: '2024-07-31T00:00:00Z',
    updated_at: '2024-07-31T00:00:00Z',
  },
  {
    id: '8',
    clinic_id: 'clinic-1',
    year_month: '2024-08',
    total_revenue: 7500000,
    insurance_revenue: 5300000,
    self_pay_revenue: 2200000,
    personnel_cost: 3400000,
    material_cost: 1500000,
    fixed_cost: 1200000,
    other_cost: 340000,
    new_patients: 35,
    returning_patients: 285,
    total_patients: 320,
    treatment_count: 510,
    average_revenue_per_patient: 23438,
    created_at: '2024-08-31T00:00:00Z',
    updated_at: '2024-08-31T00:00:00Z',
  },
  {
    id: '9',
    clinic_id: 'clinic-1',
    year_month: '2024-09',
    total_revenue: 8900000,
    insurance_revenue: 6300000,
    self_pay_revenue: 2600000,
    personnel_cost: 3400000,
    material_cost: 1780000,
    fixed_cost: 1200000,
    other_cost: 440000,
    new_patients: 49,
    returning_patients: 340,
    total_patients: 389,
    treatment_count: 615,
    average_revenue_per_patient: 22878,
    created_at: '2024-09-30T00:00:00Z',
    updated_at: '2024-09-30T00:00:00Z',
  },
  {
    id: '10',
    clinic_id: 'clinic-1',
    year_month: '2024-10',
    total_revenue: 9300000,
    insurance_revenue: 6600000,
    self_pay_revenue: 2700000,
    personnel_cost: 3400000,
    material_cost: 1860000,
    fixed_cost: 1200000,
    other_cost: 470000,
    new_patients: 53,
    returning_patients: 358,
    total_patients: 411,
    treatment_count: 650,
    average_revenue_per_patient: 22627,
    created_at: '2024-10-31T00:00:00Z',
    updated_at: '2024-10-31T00:00:00Z',
  },
];

// 最新月のデータを取得
export const getLatestMonthData = (): MonthlyData => {
  return mockMonthlyData[mockMonthlyData.length - 1];
};

// 前月のデータを取得
export const getPreviousMonthData = (): MonthlyData => {
  return mockMonthlyData[mockMonthlyData.length - 2];
};

// KPI計算ユーティリティ
export const calculateKPIs = (data: MonthlyData) => {
  const profit = data.total_revenue - (data.personnel_cost + data.material_cost + data.fixed_cost + data.other_cost);
  const profitMargin = (profit / data.total_revenue) * 100;

  return {
    profit,
    profitMargin,
  };
};

// 前月比計算
export const calculateGrowthRate = (current: number, previous: number): number => {
  if (previous === 0) return 0;
  return ((current - previous) / previous) * 100;
};
