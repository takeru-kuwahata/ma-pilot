import { MonthlyData } from '../types';

// モックデータ: 月次経営データ（直近12ヶ月）
export const mockMonthlyData: MonthlyData[] = [
  {
    id: '1',
    clinicId: 'clinic-1',
    yearMonth: '2024-01',
    totalRevenue: 8500000,
    insuranceRevenue: 6000000,
    selfPayRevenue: 2500000,
    personnelCost: 3400000,
    materialCost: 1700000,
    fixedCost: 1200000,
    otherCost: 400000,
    newPatients: 45,
    returningPatients: 320,
    totalPatients: 365,
    treatmentCount: 580,
    averageRevenuePerPatient: 23288,
    createdAt: '2024-01-31T00:00:00Z',
    updatedAt: '2024-01-31T00:00:00Z',
  },
  {
    id: '2',
    clinicId: 'clinic-1',
    yearMonth: '2024-02',
    totalRevenue: 7800000,
    insuranceRevenue: 5500000,
    selfPayRevenue: 2300000,
    personnelCost: 3400000,
    materialCost: 1560000,
    fixedCost: 1200000,
    otherCost: 350000,
    newPatients: 38,
    returningPatients: 295,
    totalPatients: 333,
    treatmentCount: 530,
    averageRevenuePerPatient: 23424,
    createdAt: '2024-02-29T00:00:00Z',
    updatedAt: '2024-02-29T00:00:00Z',
  },
  {
    id: '3',
    clinicId: 'clinic-1',
    yearMonth: '2024-03',
    totalRevenue: 9200000,
    insuranceRevenue: 6500000,
    selfPayRevenue: 2700000,
    personnelCost: 3400000,
    materialCost: 1840000,
    fixedCost: 1200000,
    otherCost: 450000,
    newPatients: 52,
    returningPatients: 348,
    totalPatients: 400,
    treatmentCount: 630,
    averageRevenuePerPatient: 23000,
    createdAt: '2024-03-31T00:00:00Z',
    updatedAt: '2024-03-31T00:00:00Z',
  },
  {
    id: '4',
    clinicId: 'clinic-1',
    yearMonth: '2024-04',
    totalRevenue: 8800000,
    insuranceRevenue: 6200000,
    selfPayRevenue: 2600000,
    personnelCost: 3400000,
    materialCost: 1760000,
    fixedCost: 1200000,
    otherCost: 420000,
    newPatients: 48,
    returningPatients: 332,
    totalPatients: 380,
    treatmentCount: 600,
    averageRevenuePerPatient: 23158,
    createdAt: '2024-04-30T00:00:00Z',
    updatedAt: '2024-04-30T00:00:00Z',
  },
  {
    id: '5',
    clinicId: 'clinic-1',
    yearMonth: '2024-05',
    totalRevenue: 9500000,
    insuranceRevenue: 6700000,
    selfPayRevenue: 2800000,
    personnelCost: 3400000,
    materialCost: 1900000,
    fixedCost: 1200000,
    otherCost: 480000,
    newPatients: 55,
    returningPatients: 365,
    totalPatients: 420,
    treatmentCount: 660,
    averageRevenuePerPatient: 22619,
    createdAt: '2024-05-31T00:00:00Z',
    updatedAt: '2024-05-31T00:00:00Z',
  },
  {
    id: '6',
    clinicId: 'clinic-1',
    yearMonth: '2024-06',
    totalRevenue: 9100000,
    insuranceRevenue: 6400000,
    selfPayRevenue: 2700000,
    personnelCost: 3400000,
    materialCost: 1820000,
    fixedCost: 1200000,
    otherCost: 460000,
    newPatients: 50,
    returningPatients: 355,
    totalPatients: 405,
    treatmentCount: 640,
    averageRevenuePerPatient: 22469,
    createdAt: '2024-06-30T00:00:00Z',
    updatedAt: '2024-06-30T00:00:00Z',
  },
  {
    id: '7',
    clinicId: 'clinic-1',
    yearMonth: '2024-07',
    totalRevenue: 8600000,
    insuranceRevenue: 6100000,
    selfPayRevenue: 2500000,
    personnelCost: 3400000,
    materialCost: 1720000,
    fixedCost: 1200000,
    otherCost: 410000,
    newPatients: 46,
    returningPatients: 325,
    totalPatients: 371,
    treatmentCount: 590,
    averageRevenuePerPatient: 23180,
    createdAt: '2024-07-31T00:00:00Z',
    updatedAt: '2024-07-31T00:00:00Z',
  },
  {
    id: '8',
    clinicId: 'clinic-1',
    yearMonth: '2024-08',
    totalRevenue: 7500000,
    insuranceRevenue: 5300000,
    selfPayRevenue: 2200000,
    personnelCost: 3400000,
    materialCost: 1500000,
    fixedCost: 1200000,
    otherCost: 340000,
    newPatients: 35,
    returningPatients: 285,
    totalPatients: 320,
    treatmentCount: 510,
    averageRevenuePerPatient: 23438,
    createdAt: '2024-08-31T00:00:00Z',
    updatedAt: '2024-08-31T00:00:00Z',
  },
  {
    id: '9',
    clinicId: 'clinic-1',
    yearMonth: '2024-09',
    totalRevenue: 8900000,
    insuranceRevenue: 6300000,
    selfPayRevenue: 2600000,
    personnelCost: 3400000,
    materialCost: 1780000,
    fixedCost: 1200000,
    otherCost: 440000,
    newPatients: 49,
    returningPatients: 340,
    totalPatients: 389,
    treatmentCount: 615,
    averageRevenuePerPatient: 22878,
    createdAt: '2024-09-30T00:00:00Z',
    updatedAt: '2024-09-30T00:00:00Z',
  },
  {
    id: '10',
    clinicId: 'clinic-1',
    yearMonth: '2024-10',
    totalRevenue: 9300000,
    insuranceRevenue: 6600000,
    selfPayRevenue: 2700000,
    personnelCost: 3400000,
    materialCost: 1860000,
    fixedCost: 1200000,
    otherCost: 470000,
    newPatients: 53,
    returningPatients: 358,
    totalPatients: 411,
    treatmentCount: 650,
    averageRevenuePerPatient: 22627,
    createdAt: '2024-10-31T00:00:00Z',
    updatedAt: '2024-10-31T00:00:00Z',
  },
];

// 最新月のデータを取得
export const getLatestMonthData = (): MonthlyData => {
  return mockMonthlyData[mockMonthlyData.length - 1];
};

// 前月のデータを取得
export const getPreviousMonthData = (): MonthlyData => {
  return mockMonthlyData[mockMonthlyData.length - 2];
};

// KPI計算ユーティリティ
export const calculateKPIs = (data: MonthlyData) => {
  const profit = data.totalRevenue - (data.personnelCost + data.materialCost + data.fixedCost + data.otherCost);
  const profitMargin = (profit / data.totalRevenue) * 100;

  return {
    profit,
    profitMargin,
  };
};

// 前月比計算
export const calculateGrowthRate = (current: number, previous: number): number => {
  if (previous === 0) return 0;
  return ((current - previous) / previous) * 100;
};
